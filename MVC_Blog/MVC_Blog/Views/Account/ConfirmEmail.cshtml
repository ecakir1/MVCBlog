@{
    ViewData["Title"] = "Email Confirmation";
}
<!--
<h2>Email Confirmation</h2>
<p>Your email has been successfully confirmed. Thank you!</p>
<p>You will be redirected to the login page in 5 seconds...</p>

<script>
    setTimeout(function () {
        window.location.href = '@ViewBag.RedirectUrl'; // 5 saniye sonra Login sayfasına yönlendir
    }, 5000);
</script>
-->

<h2>Email Confirmation</h2>
<p id="confirmationMessage">Confirming your email, please wait...</p>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function confirmEmail(userId, token) {
        $.ajax({
            type: "POST",
            url: '@Url.Action("ConfirmEmailAjax", "Account")',
            data: { userId: userId, token: token },
            success: function (response) {
                if (response.success) {
                    $('#confirmationMessage').html('Your email has been successfully confirmed. Thank you!<br>You will be redirected to the login page in 5 seconds...');
                    setTimeout(function () {
                        window.location.href = '@Url.Action("Login", "Account")';
                    }, 5000);
                } else {
                    $('#confirmationMessage').html('Email confirmation failed: ' + response.message);
                }
            },
            error: function () {
                $('#confirmationMessage').html('An error occurred while confirming your email.');
            }
        });
    }

    // Extract userId and token from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get('userId');
    const token = urlParams.get('token');

    if (userId && token) {
        confirmEmail(userId, token);
    } else {
        $('#confirmationMessage').html('Invalid confirmation link.');
    }
</script>
